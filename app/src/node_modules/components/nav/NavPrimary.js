// react
var React         = require('react')
var Fluxxor       = require('fluxxor')


//components
var Icon        = require('components/Icon')

//bootstrap
var Grid 				= require('react-bootstrap/lib/Grid')
var Row 				= require('react-bootstrap/lib/Row')
var Col 				= require('react-bootstrap/lib/Col')

//helpers
var _         = require('lodash')
var log       = require('debug')('src:components:nav-primary')


module.exports = React.createClass({
  mixins: [
    Fluxxor.FluxMixin(React)
  ],
  isActive : function(navItem){
    var flux = this.getFlux()
    var route = flux.stores.routes.getCurrentRoute()
    var slug = flux.stores.routes.getCurrentParams().id
    return navItem.route === route
      && (route !== 'explore-by' && typeof navItem.slug !== 'undefined' ? navItem.slug === slug : true )
  },
  render: function () {
    log('props', this.props)
    var flux = this.getFlux();
    var navItems = [
      {slug:'issues',route:'explore-by',title:'Explore by Category', titlexs:'Categories'},
      {route:'actions',title:'Government Actions', titlexs:'Actions'},
      {route:'recommendations',title:'UPR Recommendations', titlexs:'Recommendations'},
      {route:'search',title:'Search', titlexs:'', icon:'search'}
    ]

    return (
      <nav className='nav-primary'>
        <Grid className=''>
          <ul className='nav-primary-list list-inline'>
            {
              _.map(navItems, function(navItem, key) {
                return (
                  <li key={key}>
                    <a
                      role="button"
                      aria-selected={this.isActive(navItem)}
                      title={navItem.title}
                      className={'btn' + (this.isActive(navItem) ? ' active' : '')}
                      href='#'
                      onClick={this.handleItemClick(navItem)}
                    >
                      <span className='visible-xs'>{navItem.titlexs}</span>
                      <span className='hidden-xs'>{navItem.title}</span>                      
                      {navItem.icon ? (<Icon name={navItem.icon}/>) : null}    
                    </a>
                  </li>
                )
              },this)
            }
          </ul>
        </Grid>
      </nav>
    )
  },
  handleItemClick: function (item) {
    return _.bind(function (e) {
      e.preventDefault()
      this.getFlux().actions.navigate(item.route,item.slug)
    },this)
  }
})
