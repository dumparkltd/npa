// react
var React         = require('react')
var Fluxxor      = require('fluxxor')

//components
//var SelectTaxonomy = require('components/nav/select-taxonomy')

//bootstrap
var Grid 				= require('react-bootstrap/lib/Grid')
var Row 				= require('react-bootstrap/lib/Row')
var Col 				= require('react-bootstrap/lib/Col')

//helpers
var _         = require('lodash')
var log       = require('debug')('src:components:nav-primary')


module.exports = React.createClass({
  mixins: [
    Fluxxor.FluxMixin(React)
  ],
  isActive : function(navItem){
    var flux = this.getFlux()
    var route = flux.stores.routes.getCurrentRoute()
    var slug = flux.stores.routes.getCurrentParams().id
    return navItem.route === route 
      && (typeof navItem.slug !== 'undefined' ? navItem.slug === slug : true )    
  },
  render: function () { 
    log('props', this.props)
    var flux = this.getFlux();
    var navItems = [
      {slug:'issues',route:'explore-by',title:'Explore by Category'},
      {slug:'actions',route:'all',title:'Explore Actions'},
      {slug:'recommendations',route:'all',title:'Explore Recommendations'},
      {route:'search',title:'Search'}      
    ]
   
    return (
      <nav className='nav-primary'>
        <Grid className=''>
          <Row className='nav-primary-row'>
            <Col sm='12'>
              { 
                _.map(navItems, function(navItem) {
                  return (
                    <a  
                      role="button" 
                      aria-selected={this.isActive(navItem)}
                      title={navItem.title}
                      className={'btn' + (this.isActive(navItem) ? ' active' : '')}
                      href='#'
                      onClick={this.handleItemClick(navItem)}
                    >                  
                      <div className='title'>{navItem.title}</div>
                    </a>
                  )
                },this)
              }
            </Col>
          </Row>
        </Grid>
      </nav>
    )
  },
  handleItemClick: function (item) {
    return _.bind(function (e) {
      e.preventDefault()
      this.getFlux().actions.navigate(item.route,item.slug)
    },this)
  }  
})
