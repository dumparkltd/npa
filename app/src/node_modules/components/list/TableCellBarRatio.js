//main
var React     = require('react')

//helpers
var _           = require('lodash')
var log         = require('debug')('src:components:entityListCellBar')



var TableCellBarRatio = React.createClass({

  propTypes : {
    row: React.PropTypes.object,    
    col: React.PropTypes.object    
  },
  
  render: function () {    
    log('props',this.props)
    
    var row = this.props.row
    var col = this.props.col
    
    var reminder = parseInt(row[col.value.attr]) - parseInt(row[col.ratio.attr])

    return (
      <div className='cell-bar-wrap cell-ratio-bar-wrap'>
        <span className="bar-label" 
          style={{color:col.ratio.color}}>
                  {row[col.ratio.attr]}
        </span>
        <span className="bar">
          {this.renderUnits(
            row[col.ratio.attr],
            col.ratio.color)}          
          {this.renderUnits(
            reminder,
            col.value.color)}
          <span className="bar-label bar-label-value-total" style={{ color:col.value.color  }}>
            {reminder}
          </span>
        </span>
      </div>
    )
  },
  renderUnits : function(value, color) {
    var col = this.props.col
    var unitWidth = (100 / col.maxValue) + '%'
    
    return _.map(_.fill(Array(value), 1),function(unit,i){
      return (
              <span key={i} className="bar-unit" style={{backgroundColor:color,width:unitWidth}}/>
            )
    })
  }
})


module.exports = TableCellBarRatio;