var _ = require('lodash')
var parseDate = require('utils/parseDate')

//removes whiteSpace from all values in a collection of objects
module.exports = function (collection) {
 
  
  //for all rows
  collection = _.map(collection, function(item){
    // for all columns
    var updated = {}    
    _.each(item, function(value,key){
      var referenceKeys = ['issues', 'groups', 'agencies', 'recommendations', 'treatybodies', 'articles']
      var dateKeys = ['targetdate']
      updated[key] = 
        typeof value === 'string' 
          ? referenceKeys.indexOf(key) > -1 
            ? value.replace(', ',',').split(',') 
            : dateKeys.indexOf(key) > -1 
              ? parseDate(value)
              : _.trim(value) 
          : value
    })
    return updated
  })  

  return collection
}
