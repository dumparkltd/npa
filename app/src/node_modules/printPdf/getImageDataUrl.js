module.exports = function (url, success, error, name) {
  var data, canvas, ctx
  var img = new Image()
  img.onload = function () {
    // Create the canvas element.
    canvas = document.createElement('canvas')
    canvas.width = img.width
    canvas.height = img.height
    // Get '2d' context and draw the image.
    ctx = canvas.getContext('2d')
    ctx.drawImage(img, 0, 0)
    // Get canvas data URL
    try {
      data = canvas.toDataURL()
      success({image: img, data: data, name: name})
    } catch (e) {
      error(e)
    }
  }
  // Load image URL.
  try {
    img.src = url
  } catch (e) {
    error(e)
  }
}